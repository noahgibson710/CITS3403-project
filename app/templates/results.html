{% extends "base.html" %}

{% block title %}Calorie Intake Time Series{% endblock %}

{% block content %}
<section>
    <h1>Your Health Macro Results</h1>
    <div id="results-container" style="text-align:center; font-size: 1.1rem; margin-top: 2rem;">
        <!-- The JS will inject the most recent result and the Save/Recalculate buttons here if there is a new calculation -->
    </div>
    {% if macro_posts and macro_posts|length > 0 %}
        <div class="macro-history" style="margin-top: 2rem;">
            <ul>
                {% for post in macro_posts %}
                    <li style="margin-bottom: 1.5rem; text-align:center;">
                        <p><strong>Date:</strong> {{ post.timestamp.strftime('%Y-%m-%d %H:%M') }}</p>
                        <p><strong>Gender:</strong> {{ post.gender|capitalize }}</p>
                        <p><strong>Age:</strong> {{ post.age }}</p>
                        <p><strong>Weight:</strong> {{ post.weight }} kg</p>
                        <p><strong>Height:</strong> {{ post.height }} cm</p>
                        <p><strong>BMR:</strong> {{ post.bmr }} calories/day</p>
                        <p><strong>TDEE:</strong> {{ post.tdee }} calories/day</p>
                        <form action="{{ url_for('delete_macro_post', post_id=post.id) }}" method="POST" style="display:inline-block; margin: 0 10px;">
                            <button type="submit" onclick="return confirm('Are you sure you want to delete this entry?');" style="background-color: #ff6b6b; color: #fff; font-weight: bold; padding: 8px 16px; border: none; border-radius: 8px; cursor: pointer;">Delete</button>
                        </form>
                        <form action="{{ url_for('create_feed_post', post_id=post.id) }}" method="POST" style="display:inline-block; margin: 0 10px;">
                            <button type="submit" style="background-color: #4CAF50; color: #fff; font-weight: bold; padding: 8px 16px; border: none; border-radius: 8px; cursor: pointer;">Share to Community Feed</button>
                        </form>
                    </li>
                {% endfor %}
            </ul>
        </div>
    {% else %}
        <div class="no-results-message" style="text-align:center; font-size: 1.1rem; margin-top: 2rem;">
            <p style='color:#ff6b6b;'>‚ùå No results found. Please calculate your macros first on the <a href='/calculator' style='color:#6bffff; text-decoration:underline;'>Macro Calc</a> page.</p>
        </div>
    {% endif %}
</section>

<script src="{{ url_for('static', filename='js/results.js') }}"></script>
{% endblock %}
